
<ng-container *ngIf="allPosts.length>0; else noPosts" class="col-12" >
    <div    *ngFor="let post of allPosts;let n=index;trackBy:trackById"  class="post my-3 shadow-lg mt-2  text-white col-12" style="font-weight: 500;position: relative;"> 
     
 <div class="d-flex justify-content-center align-items-center" >
    
    
    

      
 </div>







    <div>
        <div class="post_head  w-100 d-flex align-items-center justify-content-between mx-auto px-3" >
    
           <div class="d-flex align-items-center">
            <div [routerLink]="['/userProfile',post.id]" class="img_container" >
                <img [src]="post.userData.image" alt="" class="w-100">
            
                </div>
                
                <div class="mx-3 text-dark">
                <h6>{{post.userData.name}}</h6>
                <p class="date m-0">{{post.date.toDate()|date:'short'}}</p>
                </div>
           </div>
           <div (click)="showAndaHideMore(n,post.docId)" class="more d-flex justify-content-center align-items-center text-dark" style="width: 40px ;height: 40px ; border: solid rgba(0, 0, 0, 0.267) 0.1px; border-radius: 50%; ">
            <i class="bi bi-three-dots-vertical "></i>
         </div>
    
     <div *ngIf="indexOfMore==n" class="" style="position: absolute; top: 60px; right: 20px; width: 200px;">
      
       <ul class="w-100 px-0 py-2" style="list-style: none; background-color: white; color: black; padding: 20px 10px; ">
        <li (click)="pushUserInSaver(post.docId)" class="w-100 p-2 my-1 d-flex justify-content-between align-items-center">
            <i *ngIf="saved"  class="fa-solid fa-bookmark"></i>
            <i *ngIf="!saved" class="far fa-bookmark"></i>
            <p *ngIf="!saved"  class="m-0">Save Post</p>
            <p *ngIf="saved"   class="m-0">Cansle Saving</p>
        </li>
        <li *ngIf="myId==post.userData.id" (click)="deletePost(post.docId)" class="w-100 p-2 my-1 d-flex justify-content-between align-items-center">
            <i class="fa-solid fa-trash"></i>
            <p class="m-0">Delete Post</p>

        </li>
       </ul>
     </div>
            </div>
    </div>
    <!--post content  -->
    <div class="text-center text-dark" style="word-wrap: break-word;">
    <h3 >{{post.post}}</h3>
    </div>
    
    <div>
        <div class="w-100 mx-auto p-3 text-dark">
            <p>{{post.cabtio}}</p>
        </div> 
        <div *ngIf="post.imgUrl" class="w-100 d-flex justify-content-center">
            <img [src]="post.imgUrl" alt="" class="w-100 mx-auto" style="max-height: 600px;">
        </div>
    
    </div>
    <hr>
    <!-- comments && likes -->
    <div class="comments_likes container  shadow-lg bg-dark" style="height: 40px; border: none;">
    <div class="row h-100">
    <div  class="col-4 icon  h-100 ">
    
          <i   (click)="toggleLike(post.docId)" class="bi bi-heart-fill"></i>

      
    <p data-bs-toggle="offcanvas" data-bs-target="#offcanvasLike" aria-controls="offcanvasBottom" (click)="getLikes(post.docId)" class="my-0 mx-2" style="cursor: pointer;">{{post.likeCount}}</p>
         
    </div>
<!-- commentes -->
    <div (click)="getComments(post.docId)"  class="btn btn-secondary me-2"
    type="button"
    data-bs-toggle="offcanvas"
    data-bs-target="#offcanvasComments"
    aria-controls="offcanvasComments"   class="col-4 icon d-flex align-items-center">

<i     class="bi bi-chat-heart-fill mx-2">{{post.commentCount}}</i>

    
    </div>
    <div class="col-4 icon">
        <i class="bi bi-arrow-return-right"></i>
    </div>


    
    </div>
    </div>
   
    

<div class="offcanvas offcanvas-bottom col-md-6 col-12 mx-auto mb-5" tabindex="-1" id="offcanvasComments" aria-labelledby="offcanvasCommentsLabel" style="height: 80vh; overflow-y: auto;">
<div class="offcanvas-header">
<h5 id="offcanvasCommentsLabel">Comments</h5>
<button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas"></button>
</div>
<div class="offcanvas-body d-flex flex-column p-3">
<!-- Comments List -->
<div *ngFor="let c of allComments;trackBy:trackById2" class="d-flex mb-3">
<img [src]="c.userImage"
   class="rounded-circle me-2"
   width="40" height="40"
   alt="{{c.userName}}">
<div class="bg-light rounded px-3 py-2 flex-grow-1">
<strong>{{ c.userName }}</strong>
<p class="mb-1">{{ c.comment }}</p>
<small class="text-muted">{{ (c.date ).toDate()| date:'short' }}</small>
</div>
</div>

<!-- Spacer to push input to bottom -->
<div class="d-flex justify-content-center py-2">
  <div class="mt-auto pt-2 border-top col-md-5 mx-auto  col-11 px-3 mb-2" style="position: fixed;bottom: 50px; background-color: white; z-index: 99999999;">
    <div class="input-group">
    <input [(ngModel)]="comment"
           type="text"
           class="form-control"
           placeholder="Write a comment..."
           aria-label="Write a comment">
    <button class="btn btn-primary" (click)="sendComment(post.docId)"
    >
      Post
    </button>
    </div>
    </div>
</div>
</div>
</div>


  
    </div>
    
</ng-container>

<div>


</div>



<ng-template #noPosts > 
   <div class="mt-5 text-center">
    <h1 >No Posts Yet</h1>
    <h2>Add The Frist Post </h2>
   </div>
  </ng-template>

  

  <div class="offcanvas offcanvas-bottom col-md-6 col-12 mx-auto" tabindex="-1" id="offcanvasLike" aria-labelledby="offcanvasBottomLabel" style="height: 80vh !important;">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="offcanvasBottomLabel">Reactive Poeple ❤️</h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body small">
<div class="d-flex justify-content-start align-items-center">
  <div *ngFor="let like of likedPoeple;trackBy:trackById2" class="d-flex align-items-center">
    <div class="img" style="width: 40px ; height: 40px;">
      <img [src]="like.userImage" alt="" class="w-100">
    </div>
    <div>
      <h6 class="my-0 mx-2">{{like.userName}}</h6>
    </div>
    </div>
</div>
    </div>
  </div>

  <!-- post-detail.component.html -->