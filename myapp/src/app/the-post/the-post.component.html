
<ng-container *ngIf="allPosts.length>0; else noPosts" class="col-12" >
    <div    *ngFor="let post of allPosts;let n=index;trackBy:trackById"  class="post my-3 shadow-lg mt-2  text-white col-12" style="font-weight: 500;position: relative;"> 
        <!-- head of the post -->

        <div *ngIf="showComments==n" class="back p-1">
         <div (click)="closeComments()" class="wrongicon">
          <i class="fa-solid fa-xmark"></i>
         </div>
        </div>
    <div class="d-flex justify-content-center align-items-center w-100">

      <div *ngIf="showComments==n" @zoomInOut class=" text-black commentDiv col-10 mx-auto col-md-5 bg-white">
        
           <div *ngIf="post.comments" class=" w-100  py-2">
            <h4 class="text-center"> Comments  {{post.comments.length}}</h4>
           </div>
        <app-comment [comments]="post.comments"></app-comment>
           <!-- إضافة تعليق جديد -->
<div class="new-comment mt-4 bg-black" style="position: sticky; bottom: 0;">
    <div class="d-flex align-items-start">
      <!-- صورة المستخدم لإضافة التعليق -->
  
      
      <!-- حقل الإدخال -->
      <div class="w-100 p-3 bg-white" >
        <textarea
        [(ngModel)]="comment"
          class="form-control"
          rows="2"
          placeholder="add comment"
        ></textarea>
        <div class="d-flex justify-content-end mt-2">
          <button (click)="sendComment(post.docId,post.id)"  class="btn btn-primary btn-sm">
            comment
          </button>
        </div>
      </div>
    </div>
  </div>

    </div>
    </div>
         
 <div class="d-flex justify-content-center align-items-center" >
    
    <!-- <div  *ngIf="showComments==n"  class="pcomment col-12 col-md-6" @zoomInOut >
       

        <div class="" style="overflow-y: auto;">

           <div *ngIf="post.comments">
            
            <div  *ngFor="let i of post.comments|sortArray;trackBy:trackById"  class="w-100 d-flex justify-content-start  my-2 p-3 ">
                <div class="mx-2">
          
                    <div class="img mx-2" style="width: 40px; height: 40px;">
                        <img [src]="i.image" alt="" class="w-100">
                    </div>
        
                </div>
                <div class="d-flex justify-content-end" style="width: 90%;">
              <div class="w-100">
                <div  class="comment mx-3 w-100 ">
                    <div class="nameandDate d-flex justify-content-between align-items-center">
                      <h6 style="color:black; font-weight: 600;" >{{i.name}}</h6>
                    </div>
      
                <p>{{i.comment}}</p>
                            </div>
                     <div class="px-3">
                        <p *ngIf="i.date" class="date">{{(i.date)|spicialDate}}</p>
                     </div>
              </div>


             
                </div>
              
             
                </div>
               
           </div>
          
                        
            </div> 
            <div class="d-flex justify-content-start align-items-center p-3 mt-5 mb-0 w-100" style="background-color: white;  position: sticky; bottom:0;">
                <input [(ngModel)]="comment" type="text" name="" id="" class="input w-100" placeholder="Add Comment">

               
                <i (click)="sendComment(post.docId,post.id)"  class="btn bi bi-send text-bg-info text-white mx-2 p-2"  style="font-size: 20px;" ></i>
                         </div> 
    </div> -->
    

      
 </div>







    <div>
        <div class="post_head  w-100 d-flex align-items-center justify-content-between mx-auto px-3" >
    
           <div class="d-flex align-items-center">
            <div [routerLink]="['/userProfile',post.id]" class="img_container" >
                <img [src]="post.postOwnerImg" alt="" class="w-100">
            
                </div>
                
                <div class="mx-3 text-dark">
                <h6>{{post.postOwnerName}}</h6>
                <p class="date m-0">{{post.date.toDate()|date:'short'}}</p>
                </div>
           </div>
           <div (click)="showAndaHideMore(n,post.docId)" class="more d-flex justify-content-center align-items-center text-dark" style="width: 40px ;height: 40px ; border: solid rgba(0, 0, 0, 0.267) 0.1px; border-radius: 50%; ">
            <i class="bi bi-three-dots-vertical "></i>
         </div>
    
     <div *ngIf="indexOfMore==n" class="" style="position: absolute; top: 60px; right: 20px; width: 200px;">
      
       <ul class="w-100 px-0 py-2" style="list-style: none; background-color: white; color: black; padding: 20px 10px; ">
        <li (click)="pushUserInSaver(post.docId)" class="w-100 p-2 my-1 d-flex justify-content-between align-items-center">
            <i *ngIf="saved"  class="fa-solid fa-bookmark"></i>
            <i *ngIf="!saved" class="far fa-bookmark"></i>
            <p *ngIf="!saved"  class="m-0">Save Post</p>
            <p *ngIf="saved"   class="m-0">Cansle Saving</p>
        </li>
        <li *ngIf="myId==post.id" (click)="deletePost(post.docId)" class="w-100 p-2 my-1 d-flex justify-content-between align-items-center">
            <i class="fa-solid fa-trash"></i>
            <p class="m-0">Delete Post</p>

        </li>
       </ul>
     </div>
            </div>
    </div>
    <!--post content  -->
    <div class="text-center text-dark" style="word-wrap: break-word;">
    <h3 >{{post.post}}</h3>
    </div>
    
    <div>
        <div class="w-100 mx-auto p-3 text-dark">
            <p>{{post.cabtio}}</p>
        </div> 
        <div *ngIf="post.imgUrl" class="w-100 d-flex justify-content-center">
            <img [src]="post.imgUrl" alt="" class="w-100 mx-auto" style="max-height: 600px;">
        </div>
    
    </div>
    <hr>
    <!-- comments && likes -->
    <div class="comments_likes container  shadow-lg bg-dark" style="height: 40px; border: none;">
    <div class="row h-100">
    <div class="col-4 icon  h-100 ">
          <i (click)="getLike(post.docId,post.likes,post.id)" [ngStyle]="{'color' :isLiked(post.likes)? 'red':'white'}" class="bi bi-heart-fill"></i>
    
        <p *ngIf="post.likes"  style="color: white;" class="m-0 mx-2">{{post.likes.length}}</p>
    </div>
<!-- commentes -->
    <div (click)="openComments(n)" class="col-4 icon d-flex align-items-center">

<i    class="bi bi-chat-heart-fill mx-2"></i>
<p *ngIf="post.comments" class="m-0">{{post.comments.length}}</p>
    
    </div>
    <div class="col-4 icon">
        <i class="bi bi-arrow-return-right"></i>
    </div>


    
    </div>
    </div>
   
    
    </div>
    
</ng-container>

<div>


</div>



<ng-template #noPosts > 
   <div class="mt-5 text-center">
    <h1 >No Posts Yet</h1>
    <h2>Add The Frist Post </h2>
   </div>
  </ng-template>

